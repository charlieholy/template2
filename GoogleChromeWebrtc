sudo mv "Google Chrome" Google.ori
vi "Google Chrome"
#!/bin/bash
"/Applications/Google Chrome.app/Contents/MacOS/Google.ori" --args --disable-web-security --unsafely-treat-insecure-origin-as-secure="http://116.62.173.161:8080" --user-data-dir=/Users/chenpeiwen/opt/userdatadir $1
sudo chmod u+x "Google Chrome"

vi 1.html
<script>
console.log("asd");
	var eP = navigator.mediaDevices.enumerateDevices();
	console.log("asd:",eP);
</script>

./Google\ Chrome 1.html

1.html

<html>
	<head>
		<title>WebRTC capture video and audio</title>

		<style>
			.none{
				-webkit-filter: none;
			}
			.blur{
				-webkit-filter: blur(3px);
			}
			.grayscale{
				-webkit-filter: grayscale(1);
			}
			.invert{
				-webkit-filter: invert(1);
			}
			.sepia{
				-webkit-filter: sepia(1);
			}
		</style>
	</head>
	<body>
		<div>
			<label>audio Source:</label>
		<select id="audioSource"></select>
		</div>
		<div>
			<label>audio Output:</label>
		<select id="audioOutput"></select>
		</div>
		<div>
			<label>video Source:</label>
		<select id="videoSource"></select>
		</div>

		<div>
			<label>Filter:</label>
			<select id="filter">
				<option value="none">None</option>
				<option value="blur">Blur</option>
				<option value="grayscale">Grayscale</option>
				<option value="invert">Invert</option>
				<option value="sepia">Sepia</option>
			</select>
		</div>

		<section>
			<table><tr><td>
						<video autoplay playsinline id="player"></video></td><td><div id='constraints' class='output'></div></td>
				</tr></table>
		</section>
		<audio autoplay controls id='audioplayer'></audio>

		<div>
	<button id="snapshot">Take snapshout</button>
</div>
<div>
	<canvas id="picture"></canvas>
</div>
<script>
var audioSource = document.querySelector('select#audioSource');
var audioOutput = document.querySelector('select#audioOutput');
var videoSource = document.querySelector('select#videoSource');
var videoplay = document.querySelector('video#player');
var filterSelect = document.querySelector('select#filter');
var audioplay = document.querySelector('audio#audioplayer');
var divConstraints = document.querySelector('div#constraints');
	function gotDevices(deviceInfos){
			console.log("deviceInfos:",deviceInfos)
			deviceInfos.forEach(function(deviceinfo){
var option = document.createElement('option');
						option.text = deviceinfo.label;
							option.value = deviceinfo.deviceId;
					if(deviceinfo.kind === 'audioinput'){
	audioSource.appendChild(option);
						}else if(deviceinfo.kind === 'audiooutput'){
	audioOutput.appendChild(option);
							}else if(deviceinfo.kind === 'videoinput'){
	videoSource.appendChild(option);
								}
				})
		}
	function gotMediaStream(stream){
videoplay.srcObject = stream;
			var videoTrack = stream.getVideoTracks()[0];
			var videoConstraints = videoTrack.getSettings();
			divConstraints.textContent = JSON.stringify(videoConstraints,null,2);

	return navigator.mediaDevices.enumerateDevices();
		}
	function handleError(err){
console.log('getUserMedia error:',err);
		}
	function start(){
	var constraints = {
			audio:{
noiseSuppression:true,
					echoCancellation:true
				},
			video : {
				width:640,
				height:480,
				frameRate:30,
					facingMode:'enviroment'
				}
	} 
	navigator.mediaDevices.getUserMedia(constraints)
	.then(gotMediaStream)
	.then(gotDevices)
	.catch(handleError);
}
	start();
	var btn_snapshot = document.querySelector('button#snapshot');
	var canv_picture = document.querySelector('canvas#picture'); 
	btn_snapshot.onclick = function(){
 		console.log("snapshot...");
		canv_picture.getContext('2d').drawImage(videoplay,0,0,320,240);
	}
	filterSelect.onchange = function(){
  		videoplay.className = filterSelect.value;	
	}
</script>
	</body>
</html>


